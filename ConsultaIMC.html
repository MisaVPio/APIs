<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.bundle.css">
    <title>Calculadora de IMC</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .calculator {
            max-width: 400px;
            margin: 0 auto;
        }

        .calculator input {
            width: 100px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .calculator button {
            padding: 10px 20px;
        }
    </style>
</head>

<body>
    <div class="container mt-4">
        <h1 class="text-center">Calculadora de IMC</h1>
        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title"><strong>Sugerir Receita com base no IMC</strong></h5>
                <div class="form-group">
                    <label for="inputPeso">Peso(Kg)</label>
                    <input type="number" id="inputPeso" placeholder="Informe o peso em kg"> <br>
                </div>

                <div class="form-group">
                    <label for="inputAltura">Altura(cm)</label>
                    <input type="number" id="inputAltura" placeholder="Informe a altura em cm"> <br>
                </div>

                <button onclick="calcularIMC()">Calcular IMC</button>
                <div id="result"></div>
            </div>
        </div>
    </div>
    <div class="container mt-4">
        <h1 class="text-center">Adicionar</h1>
        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title"><strong>Inserir Receita</strong></h5>
                <div class="form-group">
                    <label for="inputTipo">Tipo:</label>
                    <input type="text" id="inputTipo" name="tipo" placeholder="Informe o tipo de receita"> <br>
                </div>

                <div class="form-group">
                    <label for="inputNome">Nome:</label>
                    <input type="text" id="inputNome" name="nomeReceita" placeholder="Informe o nome da receita"> <br>
                </div>

                <div class="form-group">
                    <label for="inputIngredientes">Ingredientes:</label>
                    <input type="text" id="inputIngredientes" name="ingredientes" placeholder="Informe os ingredientes">
                    <br>
                </div>


                <button onclick="inserirReceita()">Adicionar</button>
                <div id="resultReceita"></div>
            </div>
        </div>

        <div class="container mt-4">
            <h1 class="text-center">Atualizar</h1>
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title"><strong>Atualizar Receita</strong></h5>
                    <div class="form-group">
                        <label for="inputId">Id:</label>
                        <input type="number" id="inputAId" placeholder="Informe o id da receita"> <br>
                    </div>

                    <div class="form-group">
                        <label for="inputTipo">Tipo:</label>
                        <input type="text" id="inputATipo" placeholder="Informe o tipo de receita"> <br>
                    </div>

                    <div class="form-group">
                        <label for="inputNome">Nome:</label>
                        <input type="text" id="inputANome" placeholder="Informe o nome da receita"> <br>
                    </div>

                    <div class="form-group">
                        <label for="inputIngredientes">Ingredientes:</label>
                        <input type="text" id="inputAIngredientes" placeholder="Informe os ingredientes"> <br>
                    </div>


                    <button onclick="atualizarReceita()">Atualizar</button>
                    <div id="resultAtualizacao"></div>
                </div>
            </div>

            <div class="container mt-4">
                <h1 class="text-center">Deletar</h1>
                <div class="card mt-4">
                    <div class="card-body">
                        <h5 class="card-title"><strong>Deletar Receita</strong></h5>
                        <div class="form-group">
                            <label for="inputDId">Id:</label>
                            <input type="number" id="inputDId" placeholder="Informe o tipo de receita"> <br>
                        </div>
                        <button onclick="deletarReceita()">Deletar</button>
                        <div id="resultDeletar"></div>
                    </div>
                </div>
            </div>

            <script>
                const apiBaseUrl = "https://localhost:7169"

                async function calcularIMC() {
                    const peso = parseFloat(document.getElementById('inputPeso').value);
                    const altura = parseFloat(document.getElementById('inputAltura').value) / 100;

                    if (isNaN(peso) || isNaN(altura) || peso <= 0 || altura <= 0) {
                        alert('Por favor, informe um peso e altura válidos.');
                        return;
                    }

                    const imc = peso / (altura * altura);

                    fetch(`${apiBaseUrl}/Receita/${imc}`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Erro na requisição');
                            }
                            return response.json();
                        })
                        .then(receita => {
                            console.log(receita);
                            document.getElementById('result')
                                .innerHTML = `<h5>Receita Sugerida: </h5>
                    <p><strong>ID: </strong>${receita.receitaId}</p>
                    <p><strong>Nome: </strong>${receita.nomeReceita}</p>
                    <p><strong>Tipo: </strong>${receita.tipo}</p>                                   
                    <p><strong>Ingredientes: </strong>${receita.ingredientes}</p>`;
                        })
                        .catch(error => {
                            console.error('Erro: ', error);
                        });

                }
                async function inserirReceita() {

                    const tipo = document.getElementById('inputTipo').value;
                    const nome = document.getElementById('inputNome').value;
                    const ingredientes = document.getElementById('inputIngredientes').value;
                    if (tipo === "" || nome === "" || ingredientes === "") {
                        alert('Preencha todos os campos');
                        return;
                    }

                    const receita = { tipo, nome, ingredientes };
                    try {
                        const response = await fetch(`${apiBaseUrl}/Receita`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json', },
                            body: JSON.stringify(receita)
                        });



                        if (!response.ok) {
                            throw new Error('Erro na requisição');
                        }
                        const data = await response.json();
                        document.getElementById('resultReceita').innerHTML = `Receita Inseria, ${JSON.stringify(data)}`;
                    } catch (error) {
                        document.getElementById('resultReceita').innerHTML = `Erro, ${error.message}`;
                        console.logre(receita)
                    }
                }
                async function atualizarReceita() {
                    const id = document.getElementById('inputAId').value;
                    const tipo = document.getElementById('inputATipo').value;
                    const nome = document.getElementById('inputANome').value;
                    const ingredientes = document.getElementById('inputAIngredientes').value;
                    if (isNaN(id) || tipo === "" || nome === "" || ingredientes === "") {
                        alert('Preencha todos os campos');
                        return;
                    }

                    const receita = { id, tipo, nome, ingredientes };
                    try {
                        const response = await fetch(`${apiBaseUrl}/Receita/${id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json', },
                            body: JSON.stringify(receita)
                        });



                        if (!response.ok) {
                            throw new Error('Erro na requisição');
                        }
                        const data = await response.json();
                        document.getElementById('resultAtualizacao').innerHTML = `Receita Atualizada com sucesso, ${JSON.stringify(data)}`;
                    } catch (error) {
                        document.getElementById('resultAtualizacao').innerHTML = `Erro, ${error.message}`;
                        console.logre(receita)
                    }
                }
                async function deletarReceita() {
                    const id = document.getElementById('inputDId').value;

                    if (isNaN(id) || id == 0) {
                        alert('Digite um número válido');
                        return;
                    }

                    fetch(`${apiBaseUrl}/Receita/${id}`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Erro na requisição');
                            }
                            return response.json();
                        })
                        .then(receita => {
                            console.log(receita);
                            document.getElementById('resultDeletar')
                                .innerHTML = `<h5>Receita deletada com sucesso</h5>`
                        })
                        .catch(error => {
                            console.error('Erro: ', error);
                        });

                }


            </script>
</body>

</html>